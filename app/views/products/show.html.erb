<% content_for :title, "#{@product.name} Â· R-One Supply" %>

<div class="grid gap-12 lg:grid-cols-[1.1fr_0.9fr]">
  <div>
    <div class="grid gap-4 sm:grid-cols-2">
      <%= image_tag @product.primary_image, alt: @product.name, class: "aspect-[4/5] w-full rounded-3xl border border-slate-800/60 object-cover" %>
      <% @product.secondary_images.each do |image| %>
        <%= image_tag image, alt: @product.name, class: "aspect-[4/5] w-full rounded-3xl border border-slate-800/60 object-cover" %>
      <% end %>
    </div>
    <div class="mt-8 rounded-3xl border border-slate-800/60 bg-slate-900/60 p-8">
      <h2 class="text-lg font-semibold text-white">Story & fabrication</h2>
      <p class="mt-4 text-sm text-slate-300"><%= @product.description %></p>
      <div class="mt-6 grid gap-6 md:grid-cols-2">
        <div>
          <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Materials</p>
          <ul class="mt-2 space-y-2 text-sm text-slate-300">
            <% @product.materials.each do |material| %>
              <li class="flex items-center gap-2">
                <span class="h-1.5 w-1.5 rounded-full bg-cyan-300"></span>
                <%= material %>
              </li>
            <% end %>
          </ul>
        </div>
        <div>
          <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Care</p>
          <ul class="mt-2 space-y-2 text-sm text-slate-300">
            <% @product.care.each do |instruction| %>
              <li class="flex items-center gap-2">
                <span class="h-1.5 w-1.5 rounded-full bg-cyan-300"></span>
                <%= instruction %>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div>
    <div class="rounded-4xl border border-slate-800/70 bg-slate-950/70 p-8">
      <div class="flex items-center justify-between">
        <span class="rounded-full border border-slate-700 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-slate-300"><%= @product.category %></span>
        <% if @product.synced? %>
          <span class="flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-emerald-300">
            <span class="h-2 w-2 rounded-full bg-emerald-400"></span>
            Synced to Printful
          </span>
        <% else %>
          <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Draft</span>
        <% end %>
      </div>
      <h1 class="mt-6 text-4xl font-semibold text-white"><%= @product.name %></h1>
      <p class="mt-3 text-sm text-slate-300"><%= @product.description %></p>
      <p class="mt-6 text-3xl font-semibold text-white"><%= @product.formatted_price %></p>
      <div class="mt-8">
        <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Colorways</p>
        <div class="mt-3 flex flex-wrap gap-2">
          <% @product.colors.each do |color| %>
            <span class="rounded-full border border-slate-700 px-4 py-2 text-xs font-medium text-slate-200"><%= color %></span>
          <% end %>
        </div>
      </div>
      <div class="mt-6">
        <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Sizes</p>
        <div class="mt-3 flex flex-wrap gap-2">
          <% @product.sizes.each do |size| %>
            <span class="rounded-full border border-slate-700 px-4 py-2 text-xs font-medium text-slate-200"><%= size %></span>
          <% end %>
        </div>
      </div>
      <div class="mt-8 flex flex-col gap-4">
        <%= button_to "Add to cart", cart_path, method: :get, class: "inline-flex items-center justify-center rounded-full bg-white px-6 py-3 text-sm font-semibold text-slate-900 transition hover:-translate-y-0.5 hover:bg-slate-200" %>
        <%= link_to "Sync with Printful", printful_products_path(product_id: @product.id), data: { turbo_method: :post }, class: "inline-flex items-center justify-center rounded-full border border-slate-700 px-6 py-3 text-sm font-semibold text-slate-200 transition hover:border-cyan-400 hover:text-cyan-300" %>
      </div>
      <div class="mt-8 rounded-3xl border border-slate-800/60 bg-slate-900/50 p-5 text-sm text-slate-300">
        <p class="font-semibold text-slate-200">Stripe checkout preview</p>
        <p class="mt-2 text-sm">Trigger a demo checkout session to experience the Stripe flow connected to this product. No charges are made.</p>
        <%= button_to "Create demo checkout", integrations_stripe_checkout_path, params: { cart: { items: [{ id: @product.id, name: @product.name, quantity: 1, price_cents: @product.price_cents }] } }, class: "mt-4 inline-flex items-center justify-center rounded-full border border-slate-700 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-slate-200 transition hover:border-cyan-400 hover:text-cyan-300" %>
      </div>
    </div>

    <% if @related_products.any? %>
      <div class="mt-12">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold text-white">You might also like</h2>
          <%= link_to "View all", products_path, class: "text-sm font-medium text-cyan-300 transition hover:text-cyan-200" %>
        </div>
        <div class="mt-6 grid gap-6 md:grid-cols-2">
          <%= render partial: "products/product_card", collection: @related_products, as: :product %>
        </div>
      </div>
    <% end %>
  </div>
</div>
